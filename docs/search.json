[
  {
    "objectID": "tendencia.html#o-que-é-tendência",
    "href": "tendencia.html#o-que-é-tendência",
    "title": "6  Tendência",
    "section": "6.1 O que é tendência?",
    "text": "6.1 O que é tendência?\nDiz-se que uma série temporal observada possui tendência quando ela exibe um padrão de crescimento ou decrescimento em médio/longo prazo.\nA Figure 6.1 mostra a série do número mensal de acidentes com aeronaves, construída através dos dados diários mantidos pela Força Aérea Brasileira. Note uma tendência de decrescimento na série até meados de 2016, substituída então por uma tendência de crescimento.\n\nurl &lt;- 'https://www.dropbox.com/scl/fi/kq4jwbovu94u857238sus/N-mensal-de-acidentes-com-aeronaves-2013jan.csv?rlkey=n5pa45e7ht33houmiawdkjb09&dl=1'\n\nx &lt;- read.csv(url, h = T)\nacidentesFAB &lt;- ts( x, start = c(2013,1), frequency=12)\nts.plot(acidentesFAB, lwd = 2, xlab = 'Ano', ylab = 'No. acidentes')\n\n\n\n\n\n\nFigure 6.1: Número mensal de acidentes envolvendo aeronaves. Fonte: FAB"
  },
  {
    "objectID": "tendencia.html#tendência-aletória-e-tendência-determinística",
    "href": "tendencia.html#tendência-aletória-e-tendência-determinística",
    "title": "6  Tendência",
    "section": "6.2 Tendência aletória e tendência determinística",
    "text": "6.2 Tendência aletória e tendência determinística\nA tendência pode ser duas naturezas: determinística ou aleatória.\nA tendência aleatória é construída ao acaso. Considere, por exemplo, o passeio aleatório definido por \\(x_0=0\\) e \\(x_t = x_{t-1}+\\varepsilon_t\\), onde \\(\\varepsilon_t\\) é um ruído branco gaussiano com \\(\\nu=1\\). Já foi mostrado que \\(E(x_t)=0\\) e \\(Var(x_t)=t\\). A figura abaixo apresenta uma série simulada desse processo.\n\nset.seed(1)\nx = 0\nfor( t in 2:100) x[t] = x[t - 1] + rnorm(1,0,1)\nts.plot(x, lwd = 2)\n\n\n\n\nObserve que a série exibe um tendência, mas não há qualquer explicação para a sua exsitência, uma vez que este comportamento é fruto do acaso. Ainda, teremos que \\(E(x_t)=0\\), o que torna o padrão observado irrelevante.\nNa tendência determinística, há uma função T(.) que determina seu comportamento. Nesse caso, é assumido que\n\\[y_t = T(t) + \\varepsilon_t,\\] onde \\(\\varepsilon_t\\) é uma série estacionária com média \\(0\\) e variância \\(\\nu\\). Deste modo, \\(E(y_t)=T(t)\\), o que implica que \\(T(.)\\) representa o comportamento médio da série. O problema de estimar \\(T(.)\\) é denominado suavização.\nNa prática, é impossível determinar se uma tendência é aleatória ou determinística, cabendo ao estastístico procurar se há motivos para acreditar que está analisando o segundo tipo. A partir deste momento, toda tendência será considerada determinística."
  },
  {
    "objectID": "tendencia.html#o-modelo-de-tendência-polinomial",
    "href": "tendencia.html#o-modelo-de-tendência-polinomial",
    "title": "6  Tendência",
    "section": "6.3 O modelo de tendência polinomial",
    "text": "6.3 O modelo de tendência polinomial\nConsidere que a série temporal foi observada até o tempo \\(s\\). Então, a tendência é definida como uma função \\(T:(0,t]\\rightarrow \\mathbb{R}\\). O Teorema de Weierstrass afirma que, se \\(T\\) é contínua, então para qualquer \\(\\delta&gt;0\\), existe um polinômio \\(u(.)\\) tal que \\[|T(t)-u(t)|&lt;\\delta.\\] Isto quer dizer que \\(T(.)\\) sempre pode ser aproximada por um polinômio. Assim, para determinada ordem \\(p\\), é correto afirmar que\n\\[\\begin{equation}\n        y_t = \\beta_0 + \\sum_{j=1}^p \\beta_j t^j + \\varepsilon_t\n        \\end{equation}\\] onde \\(\\varepsilon_t\\) é uma série estacionária, é um modelo razoável para uma série temporal com tendência. Assumindo que \\(\\varepsilon_t\\) é um ruído branco gaussiano, tem-se o modelo de tendência polinomial de grau \\(p\\).\nFazendo \\(\\boldsymbol{f}_t'=(1,t,\\ldots,t^p)\\) , o modelo de tendência polinomial é reescrito como \\[\\boldsymbol{y}=\\boldsymbol{F}'\\boldsymbol{\\beta}+\\boldsymbol{\\varepsilon}\\] e inferências sobre \\(\\boldsymbol{\\beta}\\) e \\(\\nu\\) são feitas utilizando o modelo linear tradicional.\n\nExample 6.1 Considere o número anual de nascidos vivos no estado do Amazonas entre os anos 2000 e 20013:\n\nx &lt;- c( 67646 , 70252 , 70671 , 70751 , 71345 ,\n        73488 , 75584 , 73469 , 75030 , 75729 , \n        74188 , 76202 , 77434 , 79041)\n\nnascidos &lt;- ts(x, start =2000)\n\n\nts.plot(nascidos, lwd = 2, ylab = 'No. nascidos vivos')\nstats::acf(nascidos)\n\n\n\n\n\n\nFigure 6.2: Número de nascimentos anual no estado do Amazonas (Fonte: SINASC/SUS)\n\n\n\n\n\n\n\nFigure 6.3: Correlograma da série (Fonte: SINASC/SUS).\n\n\n\n\n\n\nVamos ajustar um modelo de tendência polinomial de ordem 1, ou seja\n\\[y_t=\\beta_0+\\beta_1 t + \\varepsilon_t\\] onde \\(t=1,\\ldots,14\\) representa os tempos \\(2000,\\ldots,2013\\).\n\ntempo &lt;- 1:14\nmod &lt;- lm( nascidos ~ poly(tempo, 1, raw = TRUE))\n\nAs estimativas de máxima verossimilhança para \\(\\beta_0\\) e \\(\\beta_1\\) são:\n\nmod$coefficients\n\n               (Intercept) poly(tempo, 1, raw = TRUE) \n                 68266.879                    715.178 \n\n\nou seja, \\[\\hat{T}(t)=\\hat{\\beta}+\\hat{\\beta}_1 t = 68.267+715 t\\] Os resíduos do modelo linear mod podem ser obtidos via função residuals. Abaixo, verificamos que a série dos resíduos oscila em torno de zero e que nenhuma autocorrelação parece ser relevante, o que dão indícios de que os erros são um ruído branco.\n\nres &lt;- residuals(mod)\nts.plot( res, main = '')\nacf(res, main = '')\n\n\n\n\n\n\nSérie dos resíduos\n\n\n\n\n\n\n\nCorrelograma dos resíduos\n\n\n\n\n\n\nAbaixo, o teste de Shapiro-Wilks não gera evidências contra a suposição de normalidade e o teste de Box-Pierce não gera evidências contra a hipótese de ruído branco.\n\nshapiro.test(res)\n\n\n    Shapiro-Wilk normality test\n\ndata:  res\nW = 0.96982, p-value = 0.8743\n\nBox.test(res)\n\n\n    Box-Pierce test\n\ndata:  res\nX-squared = 0.02156, df = 1, p-value = 0.8833\n\n\nÉ interessante notar que, para \\(t=1,\\ldots,14\\), \\[\\hat{T}(t)=\\hat{\\beta}_0+\\hat{\\beta}_1 t = \\hat{y}_t,\\] logo, os valores preditos do modelo são uma estimativa para a tendência nos pontos observados.\n\nts.plot( cbind( nascidos, fitted(mod)), col = 1:2, lwd = 2)\n\n\n\n\n\n\nLinha preta: série original. Linha vermelha: tendência estimada\n\n\n\n\n\n\n\n\n6.3.1 Previsão\nA previsão é realizada utilizando o modelo ajustado, estrapolando para um tempo não observado. Por exemplo a estimativa para 2014 (\\(t=15\\)) é\n\\[\\hat{T}(15)=\\hat{\\beta}+\\hat{\\beta}_1 15 = 78.992\\] (o valor real foi 81.145).\nÉ importante ressaltar que esse tipo de modelo é interessante para fazer inferências sobre a tendência, mas pode ser inadequado para previsões, uma vez que o polinômio é uma aproximação apenas para o intervalo observado.\n\n\n6.3.2 Seleção de modelos lineares\nO valor do Critério de Informação de Akaike (AIC) é dado por \\(-2L(\\hat{\\theta})+2k\\) onde \\(L\\) é a função de verossimilhança e \\(\\hat{\\theta}\\) e \\(k\\) são o estimador de máxima verossimilhança para \\(\\theta\\) e sua dimensão, respectivamente. O modelo com menor AIC é considerado mais adequado.\nConsidere o nível anual, em pés, do Lago Huron. Essa série já vem carregada no R sob o nome LakeHuron.\n\nts.plot(LakeHuron, lwd = 2, ylab = 'Nível (pés)')\nstats::acf(LakeHuron)\n\n\n\n\n\n\nFigure 6.4: Nível anual do Lago Huron, entre 1875 e 1972\n\n\n\n\n\n\n\nFigure 6.5: Correlograma da série\n\n\n\n\n\n\nVamos ajustar alguns modelos para tentar explica a tendêndia dessa série.\n\ntempo &lt;- 1 : length(LakeHuron)\nmod1 &lt;- lm( LakeHuron ~ poly(tempo, 1, raw = T))\nmod2 &lt;- lm( LakeHuron ~ poly(tempo, 2, raw = T))\nmod3 &lt;- lm( LakeHuron ~ poly(tempo, 3, raw = T))\nmod4 &lt;- lm( LakeHuron ~ poly(tempo, 4, raw = T))\nmod5 &lt;- lm( LakeHuron ~ poly(tempo, 5, raw = T))\nmod6 &lt;- lm( LakeHuron ~ poly(tempo, 6, raw = T))\n\nAIC(mod1)\n\n[1] 306.0957\n\nAIC(mod2)\n\n[1] 287.8407\n\nAIC(mod3)\n\n[1] 289.8391\n\nAIC(mod4)\n\n[1] 291.7127\n\nAIC(mod5)\n\n[1] 293.475\n\nAIC(mod6)\n\n[1] 291.7054\n\n\nEntre os modelos ajustados, o de ordem 2 foi aquele com o menor valor do AIC. Sua tendência estimada é\nO polinômio ajustado foi \\[\\hat{T}(t) = 581 -0,091 t + 0,001 t^2\\]\nAbaixo, apresentamos a análise de resíduos desse modelo.\n\nres &lt;- residuals(mod2)\nts.plot( res, main = '')\nabline(h = 0, lty = 2)\nacf(res, main = '')\n\n\n\n\n\n\nSérie dos resíduos\n\n\n\n\n\n\n\nCorrelograma dos resíduos\n\n\n\n\n\n\nOs resíduos parecem oscilar em torno de zero com um variância constante, mas o correlograma sugere que não temos um ruído branco. O teste de Box-Pierce, dado abaixo, confirma a nossa suspeita. Deste modo, este modelo não é adequado.\n\nBox.test(res)\n\n\n    Box-Pierce test\n\ndata:  res\nX-squared = 50.973, df = 1, p-value = 9.365e-13"
  },
  {
    "objectID": "tendencia.html#métodos-não-paramétricos-para-estimação-da-tendência",
    "href": "tendencia.html#métodos-não-paramétricos-para-estimação-da-tendência",
    "title": "6  Tendência",
    "section": "6.4 Métodos não paramétricos para estimação da tendência",
    "text": "6.4 Métodos não paramétricos para estimação da tendência\nO modelo de tendência polinomial é robusto quando relaxamos a necessidade do ruído branco ser gaussiano. Nesse sentido, as estimativas ainda são válidas, mas perdemos todos os testes de hipóteses.\nOs métodos não paramétricos independem da distribuição do ruído, sendo úteis para a análise exploratória.\n\n6.4.1 Médias Móveis\nO método das médias móveis consiste em obter \\(\\hat{T}(t)\\) através da média da série considerando os valores \\(\\{y_{t-h},\\ldots,y_t,\\ldots,y_{t+h}\\}\\), para \\(h&gt;0\\), ou seja \\[\\hat{T}_h(t)=\\frac{1}{2h+1}\\sum_{ i = t-h}^{t+h}y_i,\\;h&lt;t&lt;n-h\\]. A constante \\(h\\) é denominada largura da banda. Para compreender melhor esse estimador, considere que a relação entre pontos vizinhos é aproximadamente linear, ou seja, para qualquer \\(t\\in\\mathcal{V}_t=\\{t-h,\\ldots,t+h\\}\\) existem \\(a_\\mathcal{V}\\) e \\(b_\\mathcal{V}\\) tais que \\[y_t\\approx a_\\mathcal{V}+b_\\mathcal{V}t+\\varepsilon_t,\\] onde \\(t\\) é uma série temporal estacionária e ergódica. Então \\[\\begin{align}E(\\hat{T}(t))&=\\frac{a_\\mathcal{V}+b_\\mathcal{V}(t-h)+\\cdots+a_\\mathcal{V}+b_\\mathcal{V}t+\\cdots+a_\\mathcal{V}+b_\\mathcal{V}(t+h)}{2h+1}\\\\&=a_\\mathcal{V}+b_\\mathcal{V}t\\end{align}\\] \\[Var(\\hat{T}(t))=\\frac{\\nu}{2h+1}+\\frac{2}{2h+1}\\sum_{j=1}^{2h}j\\gamma(j)\\] Observe que, como \\(T(.)\\) é determinística e os ruídos são estacionários e ergódicos, então \\(Var(\\hat{T})\\) eventualmente vão para zero quando \\(h\\rightarrow \\infty\\). Contudo, \\(T(.)\\) é localmente linear, logo \\(\\hat{T}\\) é um estimador razoável para valores baixos de \\(h\\).\n%"
  },
  {
    "objectID": "estacionaria.html#processo-estacionário-ergódico",
    "href": "estacionaria.html#processo-estacionário-ergódico",
    "title": "2  Séries Estacionárias",
    "section": "2.1 Processo estacionário ergódico",
    "text": "2.1 Processo estacionário ergódico\nSeja \\(x_1,x_2,\\ldots,x_n\\) uma série temporal estacionária. Então, a média \\(\\mu\\) pode ser estimada por \\(\\bar{x}_n\\), uma vez que \\(E(\\bar{x})=\\mu\\). A variância essa estatística é\n\\[\\begin{align}Var(\\bar{x})&=Cov(\\bar{x}_n,\\bar{x}_n)=Cov\\left(\\sum_{i=1}^n \\frac{x_i}{n},\\sum_{j=1}^n\\frac{x_j}{n}\\right)=\\frac{1}{n^2}\\sum_{i=1}^n\\sum_{j=1}^nCov(x_i,x_j)\\\\\n&=\\frac{1}{n^2}\\left[\\sum_{i=1}^nCov(x_i,x_i)+2\\sum_{i=1}^n\\sum_{j\\neq i}Cov(x_i,x_j)\\right]\\\\\n&=\\frac{1}{n^2}\\left[n\\nu+2\\sum_{h=1}^{n-1}(n-h)\\gamma(h)\\right]=\\frac{\\nu}{n}+\\frac{2}{n}\\sum_{h=1}^{n-1}\\left(1-\\frac{h}{n}\\right)\\gamma(h)\n\\end{align}\\]\nNote que, diferente do caso independente e identicamente distribuído, \\(\\bar{x}\\) não é necessariamente um estimador adequado, conforme pode ser constatado no exemplo abaixo.\n\nExample 2.3 Seja \\(x_t\\) um processo onde \\(x_0\\sim\\hbox{Normal}(0,\\nu)\\) e \\(x_t=x_0\\) para todo \\(t&gt;0\\). Como\n\\[\\begin{align}\nE(x_t)&=E(E(x_t|x_0))=E(x_0)=0\\\\\nVar(x_t)&=E(Var(x_t|x_0))+Var(E(x_t|x_0))=E(0)+Var(x_0)=\\nu\\\\\nCov(x_t,x_{t-h})&=E( Cov(x_t,x_{t-h}|x_0))+Cov( E(x_t|x_0),E(x_{t-h}|x_0))\\\\\n&=E(0)+Cov(x_0,x_0)=Var(x_0)=\\nu\n\\end{align}\\] e, portanto, o processo é fracamente estacionário. Contudo, \\[Var(\\bar{x})=\\frac{\\nu}{n}+\\frac{2}{n}\\sum_{h=1}^{n-1}\\left(1-\\frac{h}{n}\\right)\\nu=\\nu,\\] portanto, o erro padrão não decai com o aumento do tamanho da amostra.\n\\(\\blacksquare\\)\n\nA partir do exemplo acima, fica claro que \\(\\bar{x}\\) nem sempre será um estimador adequado para uma série estacionária.\n\nDefinition 2.2 Uma série temporal estacionária é dita ser ergódica para a média se \\[\\sum_{i=1}^n\\frac{x_1}{n}\\stackrel{p}{\\rightarrow} \\mu,\\] quando \\(n\\rightarrow\\infty\\).\n\nA partir deste momento será considerado que toda série temporal estacionária é ergódica e, portanto \\(\\bar{x}\\) é um estimador para \\(\\mu\\).\n\nExample 2.4 Considere novamente o processo no (estationario_nao_ergodico?). Como \\(\\bar{x}_n=x_0\\), tem-se que, para \\(\\varepsilon&gt;0\\) arbitrário, \\(\\bar{x}\\sim\\hbox{Normal}(0,\\nu)\\) e \\[P(|\\bar{x}_n-0|&gt;\\varepsilon)=2P(x_0&gt;\\varepsilon)=2\\int_{-\\infty}^\\varepsilon \\frac{1}{\\sqrt{2\\pi\\nu}}e^{-\\frac{y^2}{2\\nu}}d\\nu&gt;\\frac{1}{2}\\] logo, \\(\\bar{x}\\) não converge em probabilidade para \\(0\\) e, portanto, o processo não é ergódico na média. \\(\\blacksquare\\)"
  },
  {
    "objectID": "estacionaria.html#ruído-branco",
    "href": "estacionaria.html#ruído-branco",
    "title": "2  Séries Estacionárias",
    "section": "2.2 Ruído branco",
    "text": "2.2 Ruído branco\n\nDefinition 2.3 A série estacionária \\(x_t\\) é dita ser um ruído branco se \\(E(x_t)=0\\), \\(Var(x_t)=\\nu\\) e \\[\\begin{equation}\n        Cov(x_t,x_s)=0,\n        \\end{equation}\\] para todo \\(t\\neq s\\). \\(\\blacksquare\\)\n\nÉ imediato que o ruído branco é uma série temporal estacionária. Além disso, pela Desigualdade de Chebyshev, para qualquer \\(\\varepsilon&gt;0\\),\n\\[P\\left(|\\bar{x}_n|\\geq\\varepsilon\\right)\\leq \\frac{E(\\bar{x}_n^2)}{\\varepsilon^2}=\\frac{Var(\\bar{x}_n)}{\\varepsilon^2}=\\frac{\\nu}{n\\varepsilon^2}\\] logo \\(\\lim_{n}P(|\\bar{x}_n|\\leq \\varepsilon)=0\\) e \\(\\bar{x}_n\\stackrel{p}{\\rightarrow}0\\). Portanto, o ruído branco é ergódico.\nConsidere agora a série temporal \\(y_t=\\mu+x_t\\), onde \\(x_t\\) é um ruído branco. Então \\[\\bar{y}_n=\\mu+\\bar{x}_n\\stackrel{p}{\\rightarrow}\\mu\\] e \\(\\bar{y}_n\\) é um estimador para \\(\\mu\\).\nEm certos momentos, será considerado que \\(x_t\\) e \\(x_s\\), para todo \\(t\\neq s\\) são independentes (essa é uma condição mais forte, pois implica em \\(Cov(x_t,x_s)=0\\)). Esse processo é denominado ruído branco independente.\nPor último, também será considerado a possibilidade de que \\(x_t\\sim\\hbox{Normal}(0,\\nu)\\), com \\(x_t\\) e \\(x_s\\) indepentens para todo \\(t\\neq s\\). Esse processo será denominado é denominado ruído branco gaussiano."
  }
]